#!/usr/bin/perl
#
eval 'exec perl -S $0 ${1+"$@"}'
	if 1 == 2;


#
# Get the root and suffix of the file
# (file name should be the first arg)
#
if ($#ARGV == 0)
{
    chop($file = `basename $ARGV[0]`);
    ($root, $suffix) = split('\.', $file);
    $ROOT = uc $root;
    #$Root = ucfirst $root;

    $suffix = $root unless $suffix;
}
    
# Try to guess from suffix
 SUFFIX: {
     $commentStart = '//', last SUFFIX if $suffix =~ /[CH]$/;
     $commentStart = '//', last SUFFIX if $suffix =~ /hpp$/;
     $commentStart = '//', last SUFFIX if $suffix =~ /cpp$/;
     #$commentStart = '/*', $commentEnd = '*/', $commentBlock = '**', last SUFFIX if $suffix =~ /[ch]$/;
     # Default
     $commentStart = $commentEnd = $commentBlock = "#";
}


if (! $commentEnd)
{
    $commentEnd = $commentBlock = $commentStart;
}

# Make a nicely formatted date
@months = ("January", "February", "March", "April", "May", "June",
	   "July", "August", "September", "October", "November", "December");
@tm = localtime;

$year = 1900 + $tm[5];
$date = "$months[$tm[4]] $tm[3], $year";

# Find out who the author is
$author = $ENV{'NAME'} || (getpwuid($>))[6];


print "$commentStart\n";
while ($_ = <DATA>)
{
    s/"/\\"/g;
    s#^//#$commentBlock#;
    print eval qq/"$_"/;
}
print "$commentEnd\n";

$templateFile = "$ENV{'HOME'}/.template.$suffix";
if (-r $templateFile)
{
    open(TEMPL, "<$templateFile") || die "Can't open $templateFile: $!\n";
    while ($_ = <TEMPL>)
    {
	s/"/\\"/g;
	print eval qq/"$_"/;
    }
}
#// Copyright ${year} by ${author}
__END__
// Copyright ${year} by Vincent B. Greff
//    
// CREATED: ${date} 
